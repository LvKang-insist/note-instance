# 4/2

### 		今天遇到内存泄露的场景： ViewPager 嵌套 Fragment。

​			如果使用的是 ：FragmentStatePagerAdapter 适配器，如果 Fragment 不显示，则会被销毁，在 这个适配器中。**Fragment 不能被添加进 List 中，然后在getItem 时获取集合数据**，这种中情况会造成内存泄露。 当 fragment 销毁后 List 还持有者 Fragment 的适配器，造成不能被回收。 **解决的办法就是直接 newFragment。而不是 使用集合存放**

​			如果用的是 FragmentPagerAdapter ，则会全部缓存，不存在泄露的问题。但是这种不适合大量页面的需求

### 		Glide 清理缓存

​		如果 列表中有使用 glide 加载图。这些图片会全部被加载到内存中，造成资源的浪费，甚至会 OOM，解决的办法就是当 列表中的条目不可见时 清除 Glide 的缓存

```kotlin
override fun onViewRecycled(holder: BaseViewHolder) { 
     Glide.with(imageView.context).clear(imageView)
}
```

​	  Glide 加载图片的顺序：从内存加载 -> 从磁盘加载 ->网络加载 